<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Create Digest</title>
<link type="text/css" href="/css/admin.css" rel="stylesheet" />
<script type="text/javascript" src="js/jquery-1.3.2.js"></script>
<script type="text/javascript" src="js/json2.js"></script>
<script type="text/javascript" src="js/jsonrpc.js"></script>
<script type="text/javascript">
jQuery(document).ready(function() {  
  jQuery('#returnJson').val("");
  jQuery('#submit').click(function() {
	  setStatus("processing");
    var command = "CREATE_DIGEST";

    var params = {};
    params.projectId = jQuery('#projectId').val()
	params.domain = jQuery('#domain').val()
	params.digestWaveId = jQuery('#digestWaveId').val();
	params.name = jQuery('#digestName').val();
	params.description = jQuery('#description').val();
	params.installerThumbnailUrl = jQuery('#installerThumbnailUrl').val() != null? jQuery('#installerThumbnailUrl').val() : "http://aggfiwave.appspot.com/images/forumbotty_thumb_old_2.png";
	params.installerIconUrl = jQuery('#installerIconUrl').val() != null? jQuery('#installerIconUrl').val() : "http://aggfiwave.appspot.com/images/forumbotty_thumb_old_2.png";
	params.robotThumbnailUrl = jQuery('#robotThumbnailUrl').val() != null? jQuery('#robotThumbnailUrl').val() : "http://aggfiwave.appspot.com/images/forumbotty_thumb_old_2.png";
	params.forumSiteUrl = jQuery('#forumSiteUrl').val() != null? jQuery('#forumSiteUrl').val() : "http://ugolki.blogspot.com";
	params.googlegroupsId = jQuery('#googlegroupsId').val();
	params.ownerId = jQuery('#ownerId').val();
	params.author = jQuery('#author').val();
	//var str = JSON.stringify(o);
    //var params = JSON.parse(str);
    
    jsonrpc.makeRequest(command, params, function(data) {
      try {
	      var json = JSON.parse(data);
	      if(json.error != null){
	    	  jQuery('#returnJson').val(json.error );
	    	  clearStatus();
	      }else{
		      json = JSON.parse(json.result);
		      var installerUrl = json.installerUrl;
		      var digestWaveId = json.digestWaveId;
		      var projectName = json.projectName;
		      var robotId = json.robotId;
		      var message = json.message;
		      clearStatus();
	    	  jQuery('#returnJson').val(message + "\n" +  "installerUrl: " + installerUrl + "\n" + "digestWaveId: " + digestWaveId + "\n" + "projectName: " + projectName + "\n" + "robotId: " + robotId);
	      }
      } catch (exception) {
         // var error = data.error != null ? data.error : "";
         clearStatus();
        jQuery('#returnJson').val('json parse exception: ' + "response: " + data + "; " + exception);
      }
    }); 
  });
});
</script>

</head>
<style>
</style>
<body>
<div style="border: 1px solid black; font-size: 18;">
Use the form below to create your own Digest. Then you can tell your friends to "follow" the digest wave and they will see unread items in the digest.
This is only Proof of Concept version, future versions will (hopefully) include Wave gadget with digest creation, administration and reporting features.
Here is the list of additional features compared to original ForumBotty: <br>
1. Create Digest on the fly - no need to download/setup/deploy the source code.<br>
2. Ease of use - wave with Extension Installer for newly created Digest is automatically added to the Digest Wave<br>
Please let me know what you think, you opinion matters!
</div>
<h3 align="center">Create Digest</h3>
<fieldset>
<table>
	<tr>
		<td>Owner Id:</td>
		<td>
		<input type="text" style="width: 450px;" id="ownerId" />
		</td>
		<td style="width: 420px;"> <font size="2.5">Google Wave Id of the owner (yourId@googlewave.com). Owner will be automatically added to the Digest Wave, and added to Digest administrators when administration feature will be completed.</font> </td>
	</tr>
	<tr>
		<td>Author Name:</td>
		<td>
		<input type="text" style="width: 450px;" id="author" />
		</td>
		<td style="width: 420px;"> <font size="2.5">Your name. Will be displayed as author name in Extension Installer.</font> </td>
	</tr>
	<tr>
		<td>Project Id:</td>
		<td><input style="width: 450px;" id="projectId" /></td>
		<td style="width: 520px;"> <font size="2.5">Used as "proxyFor" - must be unique, i.e. the robot address will be: digestbotty+[projectId]@appspot.com. Only lower case alpha numerical characters are allowed</font> </td>
	</tr>
	<tr>
		<td>Domain:</td>
		<td>
		<input type="text" style="width: 450px;" id="domain" value="googlewave.com" readonly="true"/>
		</td>
		<td style="width: 420px;"> <font size="2.5">Currently only preview domain supported</font> </td>
	</tr>
	<tr>
		<td>Digest Name:</td>
		<td>
		<input type="text" style="width: 450px;" id="digestName" />
		</td>
		<td style="width: 420px;"> <font size="2.5">Digest name, as it will appear in Extension Installer</font> </td>
	</tr>
	<tr>
		<td>Description:</td>
		<td>
		<input type="text" style="width: 450px;" id="description" />
		</td>
		<td style="width: 420px;"> <font size="2.5">*Optional. Description of the forum, as it will appear in Extension Installer.</font> </td>
	</tr>
	<tr>
		<td>Installer Thumbnail Url:</td>
		<td>
		<input type="text" style="width: 450px;" id="installerThumbnailUrl" />
		</td>
		<td style="width: 420px;"> <font size="2.5">*Optional. Image that will be displayed in the Extension Installer. If omitted - default image will be used.</font> </td>
	</tr>
	<tr>
		<td>Toolbar Icon Url:</td>
		<td>
		<input type="text" style="width: 450px;" id="toolbarIconUrl" />
		</td>
		<td style="width: 420px;"> <font size="2.5">*Optional. Image that will be displayed in the Toolbar. If omitted - default image will be used.</font> </td>
	</tr>
	<tr>
		<td>Robot Thumbnail Url:</td>
		<td>
		<input type="text" style="width: 450px;" id="robotThumbnailUrl" />
		</td>
		<td style="width: 420px;"> <font size="2.5">*Optional. The forum robot icon. If omitted - default image will be used.</font> </td>
	</tr>
	<tr>
		<td>Forum Site Url:</td>
		<td>
		<input type="text" style="width: 450px;" id="forumSiteUrl" />
		</td>
		<td style="width: 420px;"> <font size="2.5">*Optional. The forum site - as displayed when clicking on the forum robot. If omitted - default site will be used.</font> </td>
	</tr>
	<tr>
		<td>Google Groups Id:</td>
		<td>
		<input type="text" style="width: 450px;" id="googlegroupsId"/>
		</td>
		<td style="width: 420px;"> <font size="2.5">*Optional. Will be added as default participant for this forum. Go <a href="http://googlewave.blogspot.com/2009/12/waving-with-groups.html">here</a> for more info. The group should be configured so anyone can post to it.</font> </td>
	</tr>
	
</table>
<br>
<input id="submit" type="button" value="submit request"/>
<br><br>
output:<br>
<div id="status"></div>
<textarea id="returnJson" cols="100" rows="5" readonly="true"></textarea>
<script>
function setStatus(msg) {
	  jQuery('#status').html('&nbsp;' + msg + '&nbsp;');
};

function clearStatus() {
	  jQuery('#status').empty();
};
</script>
</body>
</html>
